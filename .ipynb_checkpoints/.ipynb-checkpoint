{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Dependencies and Setup\n",
    "import pandas as pd\n",
    "\n",
    "# Read Purchasing File and store into Pandas data frame\n",
    "crime_data = pd.read_csv(\"Data/austin_crime.csv\", low_memory=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Incident Number</th>\n",
       "      <th>Highest Offense Description</th>\n",
       "      <th>Highest Offense Code</th>\n",
       "      <th>Family Violence</th>\n",
       "      <th>Occurred Date Time</th>\n",
       "      <th>Occurred Date</th>\n",
       "      <th>Occurred Time</th>\n",
       "      <th>Report Date Time</th>\n",
       "      <th>Report Date</th>\n",
       "      <th>Report Time</th>\n",
       "      <th>...</th>\n",
       "      <th>Census Tract</th>\n",
       "      <th>Clearance Status</th>\n",
       "      <th>Clearance Date</th>\n",
       "      <th>UCR Category</th>\n",
       "      <th>Category Description</th>\n",
       "      <th>X-coordinate</th>\n",
       "      <th>Y-coordinate</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Location</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2019891702</td>\n",
       "      <td>CRIMINAL TRESPASS</td>\n",
       "      <td>2716</td>\n",
       "      <td>N</td>\n",
       "      <td>03/30/2019 08:44:00 PM</td>\n",
       "      <td>03/30/2019</td>\n",
       "      <td>2044.0</td>\n",
       "      <td>03/30/2019 08:59:00 PM</td>\n",
       "      <td>03/30/2019</td>\n",
       "      <td>2059.0</td>\n",
       "      <td>...</td>\n",
       "      <td>11.00</td>\n",
       "      <td>C</td>\n",
       "      <td>03/30/2019</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3117057.0</td>\n",
       "      <td>3117057.0</td>\n",
       "      <td>30.269060</td>\n",
       "      <td>-97.734085</td>\n",
       "      <td>(30.26905967, -97.73408544)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>20195013370</td>\n",
       "      <td>THEFT</td>\n",
       "      <td>600</td>\n",
       "      <td>N</td>\n",
       "      <td>03/23/2019 06:00:00 PM</td>\n",
       "      <td>03/23/2019</td>\n",
       "      <td>1800.0</td>\n",
       "      <td>04/01/2019 03:47:00 PM</td>\n",
       "      <td>04/01/2019</td>\n",
       "      <td>1547.0</td>\n",
       "      <td>...</td>\n",
       "      <td>21.07</td>\n",
       "      <td>N</td>\n",
       "      <td>04/03/2019</td>\n",
       "      <td>23H</td>\n",
       "      <td>Theft</td>\n",
       "      <td>3133783.0</td>\n",
       "      <td>3133783.0</td>\n",
       "      <td>30.302208</td>\n",
       "      <td>-97.680177</td>\n",
       "      <td>(30.30220794, -97.6801768)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>20172571868</td>\n",
       "      <td>AGG ROBBERY/DEADLY WEAPON</td>\n",
       "      <td>300</td>\n",
       "      <td>N</td>\n",
       "      <td>09/14/2017 10:37:00 PM</td>\n",
       "      <td>09/14/2017</td>\n",
       "      <td>2237.0</td>\n",
       "      <td>09/14/2017 10:37:00 PM</td>\n",
       "      <td>09/14/2017</td>\n",
       "      <td>2237.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18.04</td>\n",
       "      <td>O</td>\n",
       "      <td>09/20/2017</td>\n",
       "      <td>120</td>\n",
       "      <td>Robbery</td>\n",
       "      <td>3125442.0</td>\n",
       "      <td>3125442.0</td>\n",
       "      <td>30.333542</td>\n",
       "      <td>-97.705762</td>\n",
       "      <td>(30.33354183, -97.70576196)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2019920086</td>\n",
       "      <td>FAMILY DISTURBANCE</td>\n",
       "      <td>3400</td>\n",
       "      <td>N</td>\n",
       "      <td>04/02/2019 01:49:00 AM</td>\n",
       "      <td>04/02/2019</td>\n",
       "      <td>149.0</td>\n",
       "      <td>04/02/2019 01:49:00 AM</td>\n",
       "      <td>04/02/2019</td>\n",
       "      <td>149.0</td>\n",
       "      <td>...</td>\n",
       "      <td>15.03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3125614.0</td>\n",
       "      <td>3125614.0</td>\n",
       "      <td>30.332481</td>\n",
       "      <td>-97.705246</td>\n",
       "      <td>(30.3324806, -97.70524551)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2019891685</td>\n",
       "      <td>POSS MARIJUANA</td>\n",
       "      <td>1803</td>\n",
       "      <td>N</td>\n",
       "      <td>03/30/2019 10:36:00 PM</td>\n",
       "      <td>03/30/2019</td>\n",
       "      <td>2236.0</td>\n",
       "      <td>03/30/2019 10:36:00 PM</td>\n",
       "      <td>03/30/2019</td>\n",
       "      <td>2236.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7.00</td>\n",
       "      <td>C</td>\n",
       "      <td>04/02/2019</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3117721.0</td>\n",
       "      <td>3117721.0</td>\n",
       "      <td>30.274861</td>\n",
       "      <td>-97.731825</td>\n",
       "      <td>(30.27486103, -97.73182518)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Incident Number Highest Offense Description  Highest Offense Code  \\\n",
       "0       2019891702           CRIMINAL TRESPASS                  2716   \n",
       "1      20195013370                       THEFT                   600   \n",
       "2      20172571868   AGG ROBBERY/DEADLY WEAPON                   300   \n",
       "3       2019920086          FAMILY DISTURBANCE                  3400   \n",
       "4       2019891685              POSS MARIJUANA                  1803   \n",
       "\n",
       "  Family Violence      Occurred Date Time Occurred Date  Occurred Time  \\\n",
       "0               N  03/30/2019 08:44:00 PM    03/30/2019         2044.0   \n",
       "1               N  03/23/2019 06:00:00 PM    03/23/2019         1800.0   \n",
       "2               N  09/14/2017 10:37:00 PM    09/14/2017         2237.0   \n",
       "3               N  04/02/2019 01:49:00 AM    04/02/2019          149.0   \n",
       "4               N  03/30/2019 10:36:00 PM    03/30/2019         2236.0   \n",
       "\n",
       "         Report Date Time Report Date  Report Time  ... Census Tract  \\\n",
       "0  03/30/2019 08:59:00 PM  03/30/2019       2059.0  ...        11.00   \n",
       "1  04/01/2019 03:47:00 PM  04/01/2019       1547.0  ...        21.07   \n",
       "2  09/14/2017 10:37:00 PM  09/14/2017       2237.0  ...        18.04   \n",
       "3  04/02/2019 01:49:00 AM  04/02/2019        149.0  ...        15.03   \n",
       "4  03/30/2019 10:36:00 PM  03/30/2019       2236.0  ...         7.00   \n",
       "\n",
       "  Clearance Status  Clearance Date  UCR Category Category Description  \\\n",
       "0                C      03/30/2019           NaN                  NaN   \n",
       "1                N      04/03/2019           23H                Theft   \n",
       "2                O      09/20/2017           120              Robbery   \n",
       "3              NaN             NaN           NaN                  NaN   \n",
       "4                C      04/02/2019           NaN                  NaN   \n",
       "\n",
       "  X-coordinate Y-coordinate   Latitude  Longitude                     Location  \n",
       "0    3117057.0    3117057.0  30.269060 -97.734085  (30.26905967, -97.73408544)  \n",
       "1    3133783.0    3133783.0  30.302208 -97.680177   (30.30220794, -97.6801768)  \n",
       "2    3125442.0    3125442.0  30.333542 -97.705762  (30.33354183, -97.70576196)  \n",
       "3    3125614.0    3125614.0  30.332481 -97.705246   (30.3324806, -97.70524551)  \n",
       "4    3117721.0    3117721.0  30.274861 -97.731825  (30.27486103, -97.73182518)  \n",
       "\n",
       "[5 rows x 27 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "crime_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "crime_data=crime_data.dropna()\n",
    "crime_data[\"Date\"]=pd.to_datetime(crime_data[\"Occurred Date Time\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2019-04-12 15:43:00\n",
      "2003-01-01 00:01:00\n"
     ]
    }
   ],
   "source": [
    "ride_start_date = \"2016-06-04 00:10:19-05:00\"\n",
    "ride_end_date = \"2017-04-13 18:56:41-05:00\"\n",
    "print(crime_data[\"Date\"].max())\n",
    "print(crime_data[\"Date\"].min())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "filter = (crime_data['Date'] > ride_start_date) & (crime_data['Date'] <= ride_end_date)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "crime_data=crime_data.loc[filter]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2017-04-13 18:40:00\n",
      "2016-06-04 01:30:00\n"
     ]
    }
   ],
   "source": [
    "print(crime_data[\"Date\"].max())\n",
    "print(crime_data[\"Date\"].min())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Incident Number</th>\n",
       "      <th>Highest Offense Description</th>\n",
       "      <th>Highest Offense Code</th>\n",
       "      <th>Family Violence</th>\n",
       "      <th>Occurred Date Time</th>\n",
       "      <th>Occurred Date</th>\n",
       "      <th>Occurred Time</th>\n",
       "      <th>Report Date Time</th>\n",
       "      <th>Report Date</th>\n",
       "      <th>Report Time</th>\n",
       "      <th>...</th>\n",
       "      <th>Clearance Status</th>\n",
       "      <th>Clearance Date</th>\n",
       "      <th>UCR Category</th>\n",
       "      <th>Category Description</th>\n",
       "      <th>X-coordinate</th>\n",
       "      <th>Y-coordinate</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Location</th>\n",
       "      <th>Date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>147</th>\n",
       "      <td>2017621909</td>\n",
       "      <td>BURGLARY OF VEHICLE</td>\n",
       "      <td>601</td>\n",
       "      <td>N</td>\n",
       "      <td>03/03/2017 09:31:00 PM</td>\n",
       "      <td>03/03/2017</td>\n",
       "      <td>2131.0</td>\n",
       "      <td>03/03/2017 09:31:00 PM</td>\n",
       "      <td>03/03/2017</td>\n",
       "      <td>2131.0</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>03/28/2017</td>\n",
       "      <td>23F</td>\n",
       "      <td>Theft</td>\n",
       "      <td>3099306.0</td>\n",
       "      <td>3099306.0</td>\n",
       "      <td>30.162911</td>\n",
       "      <td>-97.793123</td>\n",
       "      <td>(30.16291061, -97.79312325)</td>\n",
       "      <td>2017-03-03 21:31:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>166</th>\n",
       "      <td>20163581310</td>\n",
       "      <td>BURGLARY OF RESIDENCE</td>\n",
       "      <td>500</td>\n",
       "      <td>N</td>\n",
       "      <td>12/23/2016 06:23:00 PM</td>\n",
       "      <td>12/23/2016</td>\n",
       "      <td>1823.0</td>\n",
       "      <td>12/23/2016 06:23:00 PM</td>\n",
       "      <td>12/23/2016</td>\n",
       "      <td>1823.0</td>\n",
       "      <td>...</td>\n",
       "      <td>C</td>\n",
       "      <td>12/23/2016</td>\n",
       "      <td>220</td>\n",
       "      <td>Burglary</td>\n",
       "      <td>3135997.0</td>\n",
       "      <td>3135997.0</td>\n",
       "      <td>30.309300</td>\n",
       "      <td>-97.672964</td>\n",
       "      <td>(30.30930019, -97.6729636)</td>\n",
       "      <td>2016-12-23 18:23:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>407</th>\n",
       "      <td>20168003574</td>\n",
       "      <td>BURGLARY OF VEHICLE</td>\n",
       "      <td>601</td>\n",
       "      <td>N</td>\n",
       "      <td>06/22/2016 01:40:00 PM</td>\n",
       "      <td>06/22/2016</td>\n",
       "      <td>1340.0</td>\n",
       "      <td>06/22/2016 08:26:00 PM</td>\n",
       "      <td>06/22/2016</td>\n",
       "      <td>2026.0</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>12/08/2016</td>\n",
       "      <td>23F</td>\n",
       "      <td>Theft</td>\n",
       "      <td>3114731.0</td>\n",
       "      <td>3114731.0</td>\n",
       "      <td>30.225104</td>\n",
       "      <td>-97.742635</td>\n",
       "      <td>(30.22510374, -97.74263508)</td>\n",
       "      <td>2016-06-22 13:40:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>445</th>\n",
       "      <td>20175010878</td>\n",
       "      <td>THEFT FROM AUTO</td>\n",
       "      <td>603</td>\n",
       "      <td>N</td>\n",
       "      <td>03/15/2017 10:00:00 PM</td>\n",
       "      <td>03/15/2017</td>\n",
       "      <td>2200.0</td>\n",
       "      <td>03/16/2017 12:26:00 PM</td>\n",
       "      <td>03/16/2017</td>\n",
       "      <td>1226.0</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>03/23/2017</td>\n",
       "      <td>23F</td>\n",
       "      <td>Theft</td>\n",
       "      <td>3095942.0</td>\n",
       "      <td>3095942.0</td>\n",
       "      <td>30.456520</td>\n",
       "      <td>-97.796062</td>\n",
       "      <td>(30.45652049, -97.79606239)</td>\n",
       "      <td>2017-03-15 22:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1007</th>\n",
       "      <td>20165032364</td>\n",
       "      <td>THEFT</td>\n",
       "      <td>600</td>\n",
       "      <td>N</td>\n",
       "      <td>08/06/2016 03:59:00 PM</td>\n",
       "      <td>08/06/2016</td>\n",
       "      <td>1559.0</td>\n",
       "      <td>08/06/2016 03:59:00 PM</td>\n",
       "      <td>08/06/2016</td>\n",
       "      <td>1559.0</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>08/09/2016</td>\n",
       "      <td>23H</td>\n",
       "      <td>Theft</td>\n",
       "      <td>3115265.0</td>\n",
       "      <td>3115265.0</td>\n",
       "      <td>30.267031</td>\n",
       "      <td>-97.739818</td>\n",
       "      <td>(30.26703057, -97.73981801)</td>\n",
       "      <td>2016-08-06 15:59:00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Incident Number Highest Offense Description  Highest Offense Code  \\\n",
       "147        2017621909         BURGLARY OF VEHICLE                   601   \n",
       "166       20163581310       BURGLARY OF RESIDENCE                   500   \n",
       "407       20168003574         BURGLARY OF VEHICLE                   601   \n",
       "445       20175010878             THEFT FROM AUTO                   603   \n",
       "1007      20165032364                       THEFT                   600   \n",
       "\n",
       "     Family Violence      Occurred Date Time Occurred Date  Occurred Time  \\\n",
       "147                N  03/03/2017 09:31:00 PM    03/03/2017         2131.0   \n",
       "166                N  12/23/2016 06:23:00 PM    12/23/2016         1823.0   \n",
       "407                N  06/22/2016 01:40:00 PM    06/22/2016         1340.0   \n",
       "445                N  03/15/2017 10:00:00 PM    03/15/2017         2200.0   \n",
       "1007               N  08/06/2016 03:59:00 PM    08/06/2016         1559.0   \n",
       "\n",
       "            Report Date Time Report Date  Report Time  ... Clearance Status  \\\n",
       "147   03/03/2017 09:31:00 PM  03/03/2017       2131.0  ...                N   \n",
       "166   12/23/2016 06:23:00 PM  12/23/2016       1823.0  ...                C   \n",
       "407   06/22/2016 08:26:00 PM  06/22/2016       2026.0  ...                N   \n",
       "445   03/16/2017 12:26:00 PM  03/16/2017       1226.0  ...                N   \n",
       "1007  08/06/2016 03:59:00 PM  08/06/2016       1559.0  ...                N   \n",
       "\n",
       "     Clearance Date  UCR Category  Category Description X-coordinate  \\\n",
       "147      03/28/2017           23F                 Theft    3099306.0   \n",
       "166      12/23/2016           220              Burglary    3135997.0   \n",
       "407      12/08/2016           23F                 Theft    3114731.0   \n",
       "445      03/23/2017           23F                 Theft    3095942.0   \n",
       "1007     08/09/2016           23H                 Theft    3115265.0   \n",
       "\n",
       "     Y-coordinate   Latitude  Longitude                     Location  \\\n",
       "147     3099306.0  30.162911 -97.793123  (30.16291061, -97.79312325)   \n",
       "166     3135997.0  30.309300 -97.672964   (30.30930019, -97.6729636)   \n",
       "407     3114731.0  30.225104 -97.742635  (30.22510374, -97.74263508)   \n",
       "445     3095942.0  30.456520 -97.796062  (30.45652049, -97.79606239)   \n",
       "1007    3115265.0  30.267031 -97.739818  (30.26703057, -97.73981801)   \n",
       "\n",
       "                    Date  \n",
       "147  2017-03-03 21:31:00  \n",
       "166  2016-12-23 18:23:00  \n",
       "407  2016-06-22 13:40:00  \n",
       "445  2017-03-15 22:00:00  \n",
       "1007 2016-08-06 15:59:00  \n",
       "\n",
       "[5 rows x 28 columns]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "crime_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:.conda-PythonData] *",
   "language": "python",
   "name": "conda-env-.conda-PythonData-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
